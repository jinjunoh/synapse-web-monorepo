import{j as c,F as k,a as q}from"./jsx-runtime-9dc53467.js";import{r as F}from"./index-76fb7be0.js";import{c as N,d as U,e as A}from"./useThread-4746ecfe.js";import{v as d,x as m,J as P,K as f}from"./SynapseClient-ceb0e6d4.js";import{u as h}from"./useMutation-dd95c1dd.js";import{u as j}from"./useInfiniteQuery-49bff1c8.js";import"./getEndpoint-ac94413e.js";import"./OrientationBanner-1c6f5b11.js";import{C as B,t as G,v as O}from"./SynapseTableCell-a0770d03.js";import{B as z}from"./Box-ddce9904.js";import{a as H}from"./Form-afa944a6.js";function le(e,n,r,a,t,s){const{accessToken:i,keyFactory:y}=d();return j(y.getRepliesQueryKey(e,n,r,a,t),async o=>m.getReplies(i,e,r,o.pageParam,a,n,t),{...s,getNextPageParam:(o,p)=>{const l=p.flatMap(g=>g.results).length;if(o.totalNumberOfResults>l)return l}})}function ue(e,n){const{accessToken:r,keyFactory:a}=d(),t=async()=>{const s=await m.getReplyMessageUrl(e.messageKey,r);return(await fetch(s.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return P(a.getReplyQueryKey(e.threadId,e.id,e.messageKey),t,n)}function J(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.postReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function W(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.putReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function ce(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.deleteReply(r,t.replyId),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(s.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}const v=e=>{const{initialText:n,initialTitle:r,id:a,onClose:t,isReply:s,isDialog:i,openDialog:y}=e,[o,p]=F.useState(r??""),[l,g]=F.useState(n??""),{mutate:w,isLoading:I}=N({onSuccess:()=>t()}),{mutate:L,isLoading:M}=U({onSuccess:()=>t()}),{mutate:Q,isLoading:E}=A({onSuccess:()=>t()}),{mutate:D,isLoading:K}=J({onSuccess:()=>t()}),{mutate:_,isLoading:b}=W({onSuccess:()=>t()}),V=M||K||E||I||b,T=!s&&r,R=(u,x)=>{s?n?_({replyId:a,messageMarkdown:u}):D({threadId:a,messageMarkdown:u}):T?(w({title:x,threadId:a}),L({messageMarkdown:u,threadId:a})):Q({forumId:a,title:x,messageMarkdown:u})},C=q("div",{className:"bootstrap-4-backport",children:[!s&&c(H,{type:"text",placeholder:"Title",value:o,onChange:u=>p(u.target.value)}),c(O,{text:l,setText:g})]}),S=V?"Saving":"Save";return c(k,{children:i?c(B,{maxWidth:"md",open:y,onCancel:t,title:s?"Edit Reply":T?"Edit Thread":"New Thread",content:C,onConfirm:()=>R(l,o),confirmButtonText:S}):q(k,{children:[C,c(z,{display:"flex",justifyContent:"flex-end",children:c(G,{onCancel:t,onConfirm:()=>R(l,o),confirmButtonText:S})})]})})};try{v.displayName="ForumThreadEditor",v.__docgenInfo={description:"",displayName:"ForumThreadEditor",props:{initialTitle:{defaultValue:null,description:"",name:"initialTitle",required:!1,type:{name:"string"}},initialText:{defaultValue:null,description:"",name:"initialText",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},isDialog:{defaultValue:null,description:"",name:"isDialog",required:!0,type:{name:"boolean"}},openDialog:{defaultValue:null,description:"",name:"openDialog",required:!1,type:{name:"boolean"}}}}}catch{}export{v as F,ce as a,le as b,ue as u};
//# sourceMappingURL=ForumThreadEditor-a24aff82.js.map
