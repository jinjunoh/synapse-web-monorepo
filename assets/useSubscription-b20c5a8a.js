import{f as p,D as f}from"./index-7db48dfb.js";import{v as o,K as b,x as a,J as l}from"./SynapseClient-ceb0e6d4.js";import{u as g}from"./useMutation-dd95c1dd.js";import{u as d}from"./useInfiniteQuery-49bff1c8.js";import"./OrientationBanner-1c6f5b11.js";import{r as m}from"./index-76fb7be0.js";import"./getEndpoint-ac94413e.js";import"./jsx-runtime-9dc53467.js";function A(e,s){const{accessToken:u,keyFactory:c}=o();return l(c.getSubscribersQueryKey(e.objectId,e.objectType),()=>a.getSubscribers(u,e),s)}function Q(e,s,u){const{accessToken:c,keyFactory:i}=o(),r=async()=>{const t={objectType:s,idList:[e],sortByType:p.OBJECT_ID,sortDirection:f.ASC};return(await a.postSubscriptionList(c,t)).results[0]};return l(i.getSubscriptionQueryKey(e,s),r,u)}function I(e,s,u){const{accessToken:c,keyFactory:i}=o(),r=b();return d(u??i.getAllSubscriptionsQueryKey(e),async t=>{const n=t.pageParam;return await a.getAllSubscriptions(c,10,n,e)},{...s,onSuccess:t=>{t.pages.forEach(n=>{r.setQueryData(i.getSubscriptionQueryKey(n.objectId,n.objectType),n)}),s!=null&&s.onSuccess&&s.onSuccess(t)},select:t=>({pages:t.pages.flatMap(n=>n.results),pageParams:t.pageParams}),getNextPageParam:(t,n)=>{const y=n.flatMap(S=>S.results).length;if(t.totalNumberOfResults>y)return y}})}function k(e){const s=b(),{accessToken:u,keyFactory:c}=o();return g(i=>a.postSubscription(u,i),{...e,onSuccess:async(i,r,t)=>{await Promise.all([s.invalidateQueries(c.getAllSubscriptionsQueryKey()),s.invalidateQueries(c.getSubscriptionQueryKey(r.objectId,r.objectType)),s.invalidateQueries(c.getSubscribersQueryKey(r.objectId,r.objectType))]),e!=null&&e.onSuccess&&await e.onSuccess(i,r,t)}})}function K(e){const s=b(),{accessToken:u,keyFactory:c}=o();return g(i=>a.deleteSubscription(u,i.subscriptionId),{...e,onSuccess:async(i,r,t)=>{await Promise.all([s.invalidateQueries(c.getAllSubscriptionsQueryKey()),s.invalidateQueries(c.getSubscriptionQueryKey(r.objectId,r.objectType)),s.invalidateQueries(c.getSubscribersQueryKey(r.objectId,r.objectType))]),e!=null&&e.onSuccess&&await e.onSuccess(i,r,t)}})}const x=(e,s)=>{const{data:u,isLoading:c}=Q(e,s),{mutate:i,isLoading:r}=k(),{mutate:t,isLoading:n}=K(),y=c||r||n,S=m.useCallback(()=>{u?t(u):i({objectId:e,objectType:s})},[t,e,s,i,u]);return{isLoading:y,subscription:u,toggleSubscribed:S,isSubscribed:!!u}};export{x as a,I as b,A as u};
//# sourceMappingURL=useSubscription-b20c5a8a.js.map
